components:
  schemas:
    # Common types
    UUID:
      type: string
      format: uuid
      example: "550e8400-e29b-41d4-a716-446655440000"

    Timestamp:
      type: string
      format: date-time
      example: "2024-01-15T10:30:00Z"

    # Pagination
    PaginationParams:
      type: object
      properties:
        limit:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
        offset:
          type: integer
          minimum: 0
          default: 0

    PaginationMeta:
      type: object
      required:
        - total
        - limit
        - offset
      properties:
        total:
          type: integer
          description: Total number of items
        limit:
          type: integer
          description: Number of items per page
        offset:
          type: integer
          description: Current offset

    # Error responses
    Error:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: Error code
        message:
          type: string
          description: Human-readable error message
        details:
          type: object
          additionalProperties: true
          description: Additional error details

    ValidationError:
      type: object
      required:
        - code
        - message
        - errors
      properties:
        code:
          type: string
          enum: [validation_error]
        message:
          type: string
        errors:
          type: array
          items:
            type: object
            required:
              - field
              - message
            properties:
              field:
                type: string
              message:
                type: string

    # User types
    User:
      type: object
      required:
        - id
        - username
        - isAdmin
        - isDisabled
        - createdAt
      properties:
        id:
          $ref: "#/components/schemas/UUID"
        username:
          type: string
          minLength: 3
          maxLength: 50
        email:
          type: string
          format: email
        isAdmin:
          type: boolean
        isDisabled:
          type: boolean
        maxRatingLevel:
          type: integer
          minimum: 0
          maximum: 100
        adultEnabled:
          type: boolean
        preferredLanguage:
          type: string
        preferredRatingSystem:
          type: string
        lastLoginAt:
          $ref: "#/components/schemas/Timestamp"
        createdAt:
          $ref: "#/components/schemas/Timestamp"
        updatedAt:
          $ref: "#/components/schemas/Timestamp"

    UserCreate:
      type: object
      required:
        - username
        - password
      properties:
        username:
          type: string
          minLength: 3
          maxLength: 50
        email:
          type: string
          format: email
        password:
          type: string
          minLength: 8
        isAdmin:
          type: boolean
          default: false
        maxRatingLevel:
          type: integer
          minimum: 0
          maximum: 100
          default: 100
        adultEnabled:
          type: boolean
          default: false
        preferredLanguage:
          type: string

    UserUpdate:
      type: object
      properties:
        username:
          type: string
          minLength: 3
          maxLength: 50
        email:
          type: string
          format: email
        isAdmin:
          type: boolean
        isDisabled:
          type: boolean
        maxRatingLevel:
          type: integer
          minimum: 0
          maximum: 100
        adultEnabled:
          type: boolean
        preferredLanguage:
          type: string
        preferredRatingSystem:
          type: string

    # Profile types
    Profile:
      type: object
      required:
        - id
        - userId
        - name
        - isDefault
        - isKids
      properties:
        id:
          $ref: "#/components/schemas/UUID"
        userId:
          $ref: "#/components/schemas/UUID"
        name:
          type: string
        avatarUrl:
          type: string
        isDefault:
          type: boolean
        isKids:
          type: boolean
        maxRatingLevel:
          type: integer
        adultEnabled:
          type: boolean
        preferredLanguage:
          type: string
        preferredAudioLanguage:
          type: string
        preferredSubtitleLanguage:
          type: string
        autoplayNext:
          type: boolean
        autoplayPreviews:
          type: boolean
        createdAt:
          $ref: "#/components/schemas/Timestamp"

    ProfileCreate:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 50
        avatarUrl:
          type: string
        isKids:
          type: boolean
          default: false
        maxRatingLevel:
          type: integer
          minimum: 0
          maximum: 100
        preferredLanguage:
          type: string

    # Session types
    Session:
      type: object
      required:
        - id
        - userId
        - isActive
        - lastActivity
        - createdAt
      properties:
        id:
          $ref: "#/components/schemas/UUID"
        userId:
          $ref: "#/components/schemas/UUID"
        profileId:
          $ref: "#/components/schemas/UUID"
        deviceName:
          type: string
        deviceType:
          type: string
        clientName:
          type: string
        clientVersion:
          type: string
        ipAddress:
          type: string
        isActive:
          type: boolean
        lastActivity:
          $ref: "#/components/schemas/Timestamp"
        expiresAt:
          $ref: "#/components/schemas/Timestamp"
        createdAt:
          $ref: "#/components/schemas/Timestamp"

    # Library types
    LibraryType:
      type: string
      enum:
        - movie
        - tvshow
        - music
        - audiobook
        - book
        - podcast
        - photo
        - livetv
        - comics
        - adult_movie
        - adult_scene

    Library:
      type: object
      required:
        - id
        - name
        - type
        - paths
      properties:
        id:
          $ref: "#/components/schemas/UUID"
        name:
          type: string
        type:
          $ref: "#/components/schemas/LibraryType"
        paths:
          type: array
          items:
            type: string
        scanEnabled:
          type: boolean
        scanIntervalHours:
          type: integer
        lastScanAt:
          $ref: "#/components/schemas/Timestamp"
        preferredLanguage:
          type: string
        downloadImages:
          type: boolean
        downloadNfo:
          type: boolean
        generateChapters:
          type: boolean
        isPrivate:
          type: boolean
        ownerUserId:
          $ref: "#/components/schemas/UUID"
        sortOrder:
          type: integer
        icon:
          type: string
        createdAt:
          $ref: "#/components/schemas/Timestamp"
        updatedAt:
          $ref: "#/components/schemas/Timestamp"

    LibraryCreate:
      type: object
      required:
        - name
        - type
        - paths
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 100
        type:
          $ref: "#/components/schemas/LibraryType"
        paths:
          type: array
          items:
            type: string
          minItems: 1
        scanEnabled:
          type: boolean
          default: true
        scanIntervalHours:
          type: integer
          minimum: 1
          default: 24
        preferredLanguage:
          type: string
        downloadImages:
          type: boolean
          default: true
        downloadNfo:
          type: boolean
          default: false
        generateChapters:
          type: boolean
          default: false
        isPrivate:
          type: boolean
          default: false
        sortOrder:
          type: integer
          default: 0
        icon:
          type: string

    LibraryUpdate:
      type: object
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 100
        paths:
          type: array
          items:
            type: string
        scanEnabled:
          type: boolean
        scanIntervalHours:
          type: integer
          minimum: 1
        preferredLanguage:
          type: string
        downloadImages:
          type: boolean
        downloadNfo:
          type: boolean
        generateChapters:
          type: boolean
        isPrivate:
          type: boolean
        sortOrder:
          type: integer
        icon:
          type: string

    # OIDC types
    OIDCProvider:
      type: object
      required:
        - id
        - name
        - slug
        - enabled
      properties:
        id:
          $ref: "#/components/schemas/UUID"
        name:
          type: string
        slug:
          type: string
        enabled:
          type: boolean
        issuerUrl:
          type: string
        autoProvision:
          type: boolean
        defaultRole:
          type: string
        createdAt:
          $ref: "#/components/schemas/Timestamp"

    OIDCProviderPublic:
      type: object
      required:
        - name
        - slug
      properties:
        name:
          type: string
        slug:
          type: string

    # Server info
    ServerInfo:
      type: object
      required:
        - version
        - setupRequired
      properties:
        version:
          type: string
        buildTime:
          type: string
        gitCommit:
          type: string
        setupRequired:
          type: boolean
        oidcProviders:
          type: array
          items:
            $ref: "#/components/schemas/OIDCProviderPublic"

    HealthStatus:
      type: object
      required:
        - status
        - version
      properties:
        status:
          type: string
          enum: [healthy, degraded, unhealthy]
        version:
          type: string
        checks:
          type: object
          additionalProperties:
            type: string
