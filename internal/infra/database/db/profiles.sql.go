// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: profiles.sql

package db

import (
	"context"

	"github.com/google/uuid"
)

const countProfilesByUser = `-- name: CountProfilesByUser :one
SELECT COUNT(*) FROM profiles WHERE user_id = $1
`

func (q *Queries) CountProfilesByUser(ctx context.Context, userID uuid.UUID) (int64, error) {
	row := q.db.QueryRow(ctx, countProfilesByUser, userID)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const createProfile = `-- name: CreateProfile :one
INSERT INTO profiles (
    user_id, name, avatar_url, is_default, is_kids,
    max_rating_level, adult_enabled,
    preferred_language, preferred_audio_language, preferred_subtitle_language,
    autoplay_next, autoplay_previews
) VALUES (
    $1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12
) RETURNING id, user_id, name, avatar_url, is_default, is_kids, max_rating_level, adult_enabled, preferred_language, preferred_audio_language, preferred_subtitle_language, autoplay_next, autoplay_previews, created_at, updated_at, auto_play_enabled, auto_play_delay_seconds, continue_watching_days, mark_watched_percent, adult_pin_hash
`

type CreateProfileParams struct {
	UserID                    uuid.UUID `json:"userId"`
	Name                      string    `json:"name"`
	AvatarUrl                 *string   `json:"avatarUrl"`
	IsDefault                 bool      `json:"isDefault"`
	IsKids                    bool      `json:"isKids"`
	MaxRatingLevel            int32     `json:"maxRatingLevel"`
	AdultEnabled              bool      `json:"adultEnabled"`
	PreferredLanguage         *string   `json:"preferredLanguage"`
	PreferredAudioLanguage    *string   `json:"preferredAudioLanguage"`
	PreferredSubtitleLanguage *string   `json:"preferredSubtitleLanguage"`
	AutoplayNext              *bool     `json:"autoplayNext"`
	AutoplayPreviews          *bool     `json:"autoplayPreviews"`
}

func (q *Queries) CreateProfile(ctx context.Context, arg CreateProfileParams) (Profile, error) {
	row := q.db.QueryRow(ctx, createProfile,
		arg.UserID,
		arg.Name,
		arg.AvatarUrl,
		arg.IsDefault,
		arg.IsKids,
		arg.MaxRatingLevel,
		arg.AdultEnabled,
		arg.PreferredLanguage,
		arg.PreferredAudioLanguage,
		arg.PreferredSubtitleLanguage,
		arg.AutoplayNext,
		arg.AutoplayPreviews,
	)
	var i Profile
	err := row.Scan(
		&i.ID,
		&i.UserID,
		&i.Name,
		&i.AvatarUrl,
		&i.IsDefault,
		&i.IsKids,
		&i.MaxRatingLevel,
		&i.AdultEnabled,
		&i.PreferredLanguage,
		&i.PreferredAudioLanguage,
		&i.PreferredSubtitleLanguage,
		&i.AutoplayNext,
		&i.AutoplayPreviews,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.AutoPlayEnabled,
		&i.AutoPlayDelaySeconds,
		&i.ContinueWatchingDays,
		&i.MarkWatchedPercent,
		&i.AdultPinHash,
	)
	return i, err
}

const deleteProfile = `-- name: DeleteProfile :exec
DELETE FROM profiles WHERE id = $1 AND is_default = false
`

func (q *Queries) DeleteProfile(ctx context.Context, id uuid.UUID) error {
	_, err := q.db.Exec(ctx, deleteProfile, id)
	return err
}

const getDefaultProfile = `-- name: GetDefaultProfile :one
SELECT id, user_id, name, avatar_url, is_default, is_kids, max_rating_level, adult_enabled, preferred_language, preferred_audio_language, preferred_subtitle_language, autoplay_next, autoplay_previews, created_at, updated_at, auto_play_enabled, auto_play_delay_seconds, continue_watching_days, mark_watched_percent, adult_pin_hash FROM profiles
WHERE user_id = $1 AND is_default = true
`

func (q *Queries) GetDefaultProfile(ctx context.Context, userID uuid.UUID) (Profile, error) {
	row := q.db.QueryRow(ctx, getDefaultProfile, userID)
	var i Profile
	err := row.Scan(
		&i.ID,
		&i.UserID,
		&i.Name,
		&i.AvatarUrl,
		&i.IsDefault,
		&i.IsKids,
		&i.MaxRatingLevel,
		&i.AdultEnabled,
		&i.PreferredLanguage,
		&i.PreferredAudioLanguage,
		&i.PreferredSubtitleLanguage,
		&i.AutoplayNext,
		&i.AutoplayPreviews,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.AutoPlayEnabled,
		&i.AutoPlayDelaySeconds,
		&i.ContinueWatchingDays,
		&i.MarkWatchedPercent,
		&i.AdultPinHash,
	)
	return i, err
}

const getProfileByID = `-- name: GetProfileByID :one
SELECT id, user_id, name, avatar_url, is_default, is_kids, max_rating_level, adult_enabled, preferred_language, preferred_audio_language, preferred_subtitle_language, autoplay_next, autoplay_previews, created_at, updated_at, auto_play_enabled, auto_play_delay_seconds, continue_watching_days, mark_watched_percent, adult_pin_hash FROM profiles WHERE id = $1
`

func (q *Queries) GetProfileByID(ctx context.Context, id uuid.UUID) (Profile, error) {
	row := q.db.QueryRow(ctx, getProfileByID, id)
	var i Profile
	err := row.Scan(
		&i.ID,
		&i.UserID,
		&i.Name,
		&i.AvatarUrl,
		&i.IsDefault,
		&i.IsKids,
		&i.MaxRatingLevel,
		&i.AdultEnabled,
		&i.PreferredLanguage,
		&i.PreferredAudioLanguage,
		&i.PreferredSubtitleLanguage,
		&i.AutoplayNext,
		&i.AutoplayPreviews,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.AutoPlayEnabled,
		&i.AutoPlayDelaySeconds,
		&i.ContinueWatchingDays,
		&i.MarkWatchedPercent,
		&i.AdultPinHash,
	)
	return i, err
}

const listProfilesByUser = `-- name: ListProfilesByUser :many
SELECT id, user_id, name, avatar_url, is_default, is_kids, max_rating_level, adult_enabled, preferred_language, preferred_audio_language, preferred_subtitle_language, autoplay_next, autoplay_previews, created_at, updated_at, auto_play_enabled, auto_play_delay_seconds, continue_watching_days, mark_watched_percent, adult_pin_hash FROM profiles
WHERE user_id = $1
ORDER BY is_default DESC, created_at ASC
`

func (q *Queries) ListProfilesByUser(ctx context.Context, userID uuid.UUID) ([]Profile, error) {
	rows, err := q.db.Query(ctx, listProfilesByUser, userID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []Profile{}
	for rows.Next() {
		var i Profile
		if err := rows.Scan(
			&i.ID,
			&i.UserID,
			&i.Name,
			&i.AvatarUrl,
			&i.IsDefault,
			&i.IsKids,
			&i.MaxRatingLevel,
			&i.AdultEnabled,
			&i.PreferredLanguage,
			&i.PreferredAudioLanguage,
			&i.PreferredSubtitleLanguage,
			&i.AutoplayNext,
			&i.AutoplayPreviews,
			&i.CreatedAt,
			&i.UpdatedAt,
			&i.AutoPlayEnabled,
			&i.AutoPlayDelaySeconds,
			&i.ContinueWatchingDays,
			&i.MarkWatchedPercent,
			&i.AdultPinHash,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const setDefaultProfile = `-- name: SetDefaultProfile :exec
UPDATE profiles SET is_default = (id = $2)
WHERE user_id = $1
`

type SetDefaultProfileParams struct {
	UserID uuid.UUID `json:"userId"`
	ID     uuid.UUID `json:"id"`
}

func (q *Queries) SetDefaultProfile(ctx context.Context, arg SetDefaultProfileParams) error {
	_, err := q.db.Exec(ctx, setDefaultProfile, arg.UserID, arg.ID)
	return err
}

const updateProfile = `-- name: UpdateProfile :one
UPDATE profiles SET
    name = COALESCE($1, name),
    avatar_url = COALESCE($2, avatar_url),
    is_kids = COALESCE($3, is_kids),
    max_rating_level = COALESCE($4, max_rating_level),
    adult_enabled = COALESCE($5, adult_enabled),
    preferred_language = COALESCE($6, preferred_language),
    preferred_audio_language = COALESCE($7, preferred_audio_language),
    preferred_subtitle_language = COALESCE($8, preferred_subtitle_language),
    autoplay_next = COALESCE($9, autoplay_next),
    autoplay_previews = COALESCE($10, autoplay_previews)
WHERE id = $11
RETURNING id, user_id, name, avatar_url, is_default, is_kids, max_rating_level, adult_enabled, preferred_language, preferred_audio_language, preferred_subtitle_language, autoplay_next, autoplay_previews, created_at, updated_at, auto_play_enabled, auto_play_delay_seconds, continue_watching_days, mark_watched_percent, adult_pin_hash
`

type UpdateProfileParams struct {
	Name                      *string   `json:"name"`
	AvatarUrl                 *string   `json:"avatarUrl"`
	IsKids                    *bool     `json:"isKids"`
	MaxRatingLevel            *int32    `json:"maxRatingLevel"`
	AdultEnabled              *bool     `json:"adultEnabled"`
	PreferredLanguage         *string   `json:"preferredLanguage"`
	PreferredAudioLanguage    *string   `json:"preferredAudioLanguage"`
	PreferredSubtitleLanguage *string   `json:"preferredSubtitleLanguage"`
	AutoplayNext              *bool     `json:"autoplayNext"`
	AutoplayPreviews          *bool     `json:"autoplayPreviews"`
	ID                        uuid.UUID `json:"id"`
}

func (q *Queries) UpdateProfile(ctx context.Context, arg UpdateProfileParams) (Profile, error) {
	row := q.db.QueryRow(ctx, updateProfile,
		arg.Name,
		arg.AvatarUrl,
		arg.IsKids,
		arg.MaxRatingLevel,
		arg.AdultEnabled,
		arg.PreferredLanguage,
		arg.PreferredAudioLanguage,
		arg.PreferredSubtitleLanguage,
		arg.AutoplayNext,
		arg.AutoplayPreviews,
		arg.ID,
	)
	var i Profile
	err := row.Scan(
		&i.ID,
		&i.UserID,
		&i.Name,
		&i.AvatarUrl,
		&i.IsDefault,
		&i.IsKids,
		&i.MaxRatingLevel,
		&i.AdultEnabled,
		&i.PreferredLanguage,
		&i.PreferredAudioLanguage,
		&i.PreferredSubtitleLanguage,
		&i.AutoplayNext,
		&i.AutoplayPreviews,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.AutoPlayEnabled,
		&i.AutoPlayDelaySeconds,
		&i.ContinueWatchingDays,
		&i.MarkWatchedPercent,
		&i.AdultPinHash,
	)
	return i, err
}
