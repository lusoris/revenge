// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: seasons.sql

package tvshowdb

import (
	"context"
	"encoding/json"
	"time"

	"github.com/google/uuid"
	"github.com/jackc/pgx/v5/pgtype"
)

const createSeason = `-- name: CreateSeason :one
INSERT INTO tvshow.seasons (
    series_id, tmdb_id, season_number,
    name, overview,
    names_i18n, overviews_i18n,
    poster_path, episode_count, air_date, vote_average
) VALUES (
    $1, $2, $3,
    $4, $5,
    $6, $7,
    $8, $9, $10, $11
)
RETURNING id, series_id, tmdb_id, season_number, name, overview, names_i18n, overviews_i18n, poster_path, episode_count, air_date, vote_average, created_at, updated_at
`

type CreateSeasonParams struct {
	SeriesID      uuid.UUID       `json:"seriesId"`
	TmdbID        *int32          `json:"tmdbId"`
	SeasonNumber  int32           `json:"seasonNumber"`
	Name          string          `json:"name"`
	Overview      *string         `json:"overview"`
	NamesI18n     json.RawMessage `json:"namesI18n"`
	OverviewsI18n json.RawMessage `json:"overviewsI18n"`
	PosterPath    *string         `json:"posterPath"`
	EpisodeCount  int32           `json:"episodeCount"`
	AirDate       pgtype.Date     `json:"airDate"`
	VoteAverage   pgtype.Numeric  `json:"voteAverage"`
}

func (q *Queries) CreateSeason(ctx context.Context, arg CreateSeasonParams) (TvshowSeason, error) {
	row := q.db.QueryRow(ctx, createSeason,
		arg.SeriesID,
		arg.TmdbID,
		arg.SeasonNumber,
		arg.Name,
		arg.Overview,
		arg.NamesI18n,
		arg.OverviewsI18n,
		arg.PosterPath,
		arg.EpisodeCount,
		arg.AirDate,
		arg.VoteAverage,
	)
	var i TvshowSeason
	err := row.Scan(
		&i.ID,
		&i.SeriesID,
		&i.TmdbID,
		&i.SeasonNumber,
		&i.Name,
		&i.Overview,
		&i.NamesI18n,
		&i.OverviewsI18n,
		&i.PosterPath,
		&i.EpisodeCount,
		&i.AirDate,
		&i.VoteAverage,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const deleteSeason = `-- name: DeleteSeason :exec
DELETE FROM tvshow.seasons WHERE id = $1
`

func (q *Queries) DeleteSeason(ctx context.Context, id uuid.UUID) error {
	_, err := q.db.Exec(ctx, deleteSeason, id)
	return err
}

const deleteSeasonsBySeries = `-- name: DeleteSeasonsBySeries :exec
DELETE FROM tvshow.seasons WHERE series_id = $1
`

func (q *Queries) DeleteSeasonsBySeries(ctx context.Context, seriesID uuid.UUID) error {
	_, err := q.db.Exec(ctx, deleteSeasonsBySeries, seriesID)
	return err
}

const getSeason = `-- name: GetSeason :one
SELECT id, series_id, tmdb_id, season_number, name, overview, names_i18n, overviews_i18n, poster_path, episode_count, air_date, vote_average, created_at, updated_at FROM tvshow.seasons WHERE id = $1
`

func (q *Queries) GetSeason(ctx context.Context, id uuid.UUID) (TvshowSeason, error) {
	row := q.db.QueryRow(ctx, getSeason, id)
	var i TvshowSeason
	err := row.Scan(
		&i.ID,
		&i.SeriesID,
		&i.TmdbID,
		&i.SeasonNumber,
		&i.Name,
		&i.Overview,
		&i.NamesI18n,
		&i.OverviewsI18n,
		&i.PosterPath,
		&i.EpisodeCount,
		&i.AirDate,
		&i.VoteAverage,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const getSeasonByNumber = `-- name: GetSeasonByNumber :one
SELECT id, series_id, tmdb_id, season_number, name, overview, names_i18n, overviews_i18n, poster_path, episode_count, air_date, vote_average, created_at, updated_at FROM tvshow.seasons
WHERE series_id = $1 AND season_number = $2
`

type GetSeasonByNumberParams struct {
	SeriesID     uuid.UUID `json:"seriesId"`
	SeasonNumber int32     `json:"seasonNumber"`
}

func (q *Queries) GetSeasonByNumber(ctx context.Context, arg GetSeasonByNumberParams) (TvshowSeason, error) {
	row := q.db.QueryRow(ctx, getSeasonByNumber, arg.SeriesID, arg.SeasonNumber)
	var i TvshowSeason
	err := row.Scan(
		&i.ID,
		&i.SeriesID,
		&i.TmdbID,
		&i.SeasonNumber,
		&i.Name,
		&i.Overview,
		&i.NamesI18n,
		&i.OverviewsI18n,
		&i.PosterPath,
		&i.EpisodeCount,
		&i.AirDate,
		&i.VoteAverage,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const listSeasonsBySeries = `-- name: ListSeasonsBySeries :many
SELECT id, series_id, tmdb_id, season_number, name, overview, names_i18n, overviews_i18n, poster_path, episode_count, air_date, vote_average, created_at, updated_at FROM tvshow.seasons
WHERE series_id = $1
ORDER BY season_number ASC
`

func (q *Queries) ListSeasonsBySeries(ctx context.Context, seriesID uuid.UUID) ([]TvshowSeason, error) {
	rows, err := q.db.Query(ctx, listSeasonsBySeries, seriesID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []TvshowSeason{}
	for rows.Next() {
		var i TvshowSeason
		if err := rows.Scan(
			&i.ID,
			&i.SeriesID,
			&i.TmdbID,
			&i.SeasonNumber,
			&i.Name,
			&i.Overview,
			&i.NamesI18n,
			&i.OverviewsI18n,
			&i.PosterPath,
			&i.EpisodeCount,
			&i.AirDate,
			&i.VoteAverage,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const listSeasonsBySeriesWithEpisodeCount = `-- name: ListSeasonsBySeriesWithEpisodeCount :many
SELECT
    s.id, s.series_id, s.tmdb_id, s.season_number, s.name, s.overview, s.names_i18n, s.overviews_i18n, s.poster_path, s.episode_count, s.air_date, s.vote_average, s.created_at, s.updated_at,
    (SELECT COUNT(*) FROM tvshow.episodes e WHERE e.season_id = s.id) as actual_episode_count
FROM tvshow.seasons s
WHERE s.series_id = $1
ORDER BY s.season_number ASC
`

type ListSeasonsBySeriesWithEpisodeCountRow struct {
	ID                 uuid.UUID       `json:"id"`
	SeriesID           uuid.UUID       `json:"seriesId"`
	TmdbID             *int32          `json:"tmdbId"`
	SeasonNumber       int32           `json:"seasonNumber"`
	Name               string          `json:"name"`
	Overview           *string         `json:"overview"`
	NamesI18n          json.RawMessage `json:"namesI18n"`
	OverviewsI18n      json.RawMessage `json:"overviewsI18n"`
	PosterPath         *string         `json:"posterPath"`
	EpisodeCount       int32           `json:"episodeCount"`
	AirDate            pgtype.Date     `json:"airDate"`
	VoteAverage        pgtype.Numeric  `json:"voteAverage"`
	CreatedAt          time.Time       `json:"createdAt"`
	UpdatedAt          time.Time       `json:"updatedAt"`
	ActualEpisodeCount int64           `json:"actualEpisodeCount"`
}

func (q *Queries) ListSeasonsBySeriesWithEpisodeCount(ctx context.Context, seriesID uuid.UUID) ([]ListSeasonsBySeriesWithEpisodeCountRow, error) {
	rows, err := q.db.Query(ctx, listSeasonsBySeriesWithEpisodeCount, seriesID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []ListSeasonsBySeriesWithEpisodeCountRow{}
	for rows.Next() {
		var i ListSeasonsBySeriesWithEpisodeCountRow
		if err := rows.Scan(
			&i.ID,
			&i.SeriesID,
			&i.TmdbID,
			&i.SeasonNumber,
			&i.Name,
			&i.Overview,
			&i.NamesI18n,
			&i.OverviewsI18n,
			&i.PosterPath,
			&i.EpisodeCount,
			&i.AirDate,
			&i.VoteAverage,
			&i.CreatedAt,
			&i.UpdatedAt,
			&i.ActualEpisodeCount,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const updateSeason = `-- name: UpdateSeason :one
UPDATE tvshow.seasons SET
    tmdb_id = COALESCE($1, tmdb_id),
    name = COALESCE($2, name),
    overview = COALESCE($3, overview),
    names_i18n = COALESCE($4, names_i18n),
    overviews_i18n = COALESCE($5, overviews_i18n),
    poster_path = COALESCE($6, poster_path),
    episode_count = COALESCE($7, episode_count),
    air_date = COALESCE($8, air_date),
    vote_average = COALESCE($9, vote_average)
WHERE id = $10
RETURNING id, series_id, tmdb_id, season_number, name, overview, names_i18n, overviews_i18n, poster_path, episode_count, air_date, vote_average, created_at, updated_at
`

type UpdateSeasonParams struct {
	TmdbID        *int32         `json:"tmdbId"`
	Name          *string        `json:"name"`
	Overview      *string        `json:"overview"`
	NamesI18n     []byte         `json:"namesI18n"`
	OverviewsI18n []byte         `json:"overviewsI18n"`
	PosterPath    *string        `json:"posterPath"`
	EpisodeCount  *int32         `json:"episodeCount"`
	AirDate       pgtype.Date    `json:"airDate"`
	VoteAverage   pgtype.Numeric `json:"voteAverage"`
	ID            uuid.UUID      `json:"id"`
}

func (q *Queries) UpdateSeason(ctx context.Context, arg UpdateSeasonParams) (TvshowSeason, error) {
	row := q.db.QueryRow(ctx, updateSeason,
		arg.TmdbID,
		arg.Name,
		arg.Overview,
		arg.NamesI18n,
		arg.OverviewsI18n,
		arg.PosterPath,
		arg.EpisodeCount,
		arg.AirDate,
		arg.VoteAverage,
		arg.ID,
	)
	var i TvshowSeason
	err := row.Scan(
		&i.ID,
		&i.SeriesID,
		&i.TmdbID,
		&i.SeasonNumber,
		&i.Name,
		&i.Overview,
		&i.NamesI18n,
		&i.OverviewsI18n,
		&i.PosterPath,
		&i.EpisodeCount,
		&i.AirDate,
		&i.VoteAverage,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const upsertSeason = `-- name: UpsertSeason :one
INSERT INTO tvshow.seasons (
    series_id, tmdb_id, season_number,
    name, overview,
    names_i18n, overviews_i18n,
    poster_path, episode_count, air_date, vote_average
) VALUES (
    $1, $2, $3,
    $4, $5,
    $6, $7,
    $8, $9, $10, $11
)
ON CONFLICT (series_id, season_number) DO UPDATE SET
    tmdb_id = EXCLUDED.tmdb_id,
    name = EXCLUDED.name,
    overview = EXCLUDED.overview,
    names_i18n = EXCLUDED.names_i18n,
    overviews_i18n = EXCLUDED.overviews_i18n,
    poster_path = EXCLUDED.poster_path,
    episode_count = EXCLUDED.episode_count,
    air_date = EXCLUDED.air_date,
    vote_average = EXCLUDED.vote_average
RETURNING id, series_id, tmdb_id, season_number, name, overview, names_i18n, overviews_i18n, poster_path, episode_count, air_date, vote_average, created_at, updated_at
`

type UpsertSeasonParams struct {
	SeriesID      uuid.UUID       `json:"seriesId"`
	TmdbID        *int32          `json:"tmdbId"`
	SeasonNumber  int32           `json:"seasonNumber"`
	Name          string          `json:"name"`
	Overview      *string         `json:"overview"`
	NamesI18n     json.RawMessage `json:"namesI18n"`
	OverviewsI18n json.RawMessage `json:"overviewsI18n"`
	PosterPath    *string         `json:"posterPath"`
	EpisodeCount  int32           `json:"episodeCount"`
	AirDate       pgtype.Date     `json:"airDate"`
	VoteAverage   pgtype.Numeric  `json:"voteAverage"`
}

func (q *Queries) UpsertSeason(ctx context.Context, arg UpsertSeasonParams) (TvshowSeason, error) {
	row := q.db.QueryRow(ctx, upsertSeason,
		arg.SeriesID,
		arg.TmdbID,
		arg.SeasonNumber,
		arg.Name,
		arg.Overview,
		arg.NamesI18n,
		arg.OverviewsI18n,
		arg.PosterPath,
		arg.EpisodeCount,
		arg.AirDate,
		arg.VoteAverage,
	)
	var i TvshowSeason
	err := row.Scan(
		&i.ID,
		&i.SeriesID,
		&i.TmdbID,
		&i.SeasonNumber,
		&i.Name,
		&i.Overview,
		&i.NamesI18n,
		&i.OverviewsI18n,
		&i.PosterPath,
		&i.EpisodeCount,
		&i.AirDate,
		&i.VoteAverage,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}
