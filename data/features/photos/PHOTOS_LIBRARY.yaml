doc_title: Photos Library
doc_category: feature
created_date: '2026-01-31'
overall_status: âœ… Complete
status_design: âœ…
status_design_notes: '-'
status_sources: âœ…
status_sources_notes: '-'
status_instructions: âœ…
status_instructions_notes: '-'
status_code: ğŸ”´
status_code_notes: '-'
status_linting: ğŸ”´
status_linting_notes: '-'
status_unit_testing: ğŸ”´
status_unit_testing_notes: '-'
status_integration_testing: ğŸ”´
status_integration_testing_notes: '-'
technical_summary: '> Photo organization, viewing, and management


  Complete photo library:

  - **Supported Formats**: JPEG, PNG, WebP, HEIC, RAW (CR2, NEF, ARW, DNG)

  - **EXIF Extraction**: GPS, camera, lens, settings metadata

  - **Organization**: Albums, people/faces, places, events, tags

  - **Image Processing**: Thumbnails, blurhash placeholders, format conversion

  - **Viewing**: Lightbox gallery, slideshow, map view'
wiki_tagline: '> Your photo library organized by albums, people, and places'
wiki_overview: The Photos Library provides comprehensive photo management with support
  for JPEG, PNG, HEIC, and RAW formats. Organize photos into albums, tag people and
  places, and view your memories on an interactive map. The system automatically extracts
  EXIF metadata including GPS coordinates, camera settings, and timestamps. Browse
  photos with a beautiful lightbox gallery or slideshow mode.
sources:
- name: Uber fx
  url: https://pkg.go.dev/go.uber.org/fx
  note: Auto-resolved from fx
- name: go-blurhash
  url: https://pkg.go.dev/github.com/bbrks/go-blurhash
  note: Auto-resolved from go-blurhash
- name: ogen OpenAPI Generator
  url: https://pkg.go.dev/github.com/ogen-go/ogen
  note: Auto-resolved from ogen
- name: pgx PostgreSQL Driver
  url: https://pkg.go.dev/github.com/jackc/pgx/v5
  note: Auto-resolved from pgx
- name: PostgreSQL Arrays
  url: https://www.postgresql.org/docs/current/arrays.html
  note: Auto-resolved from postgresql-arrays
- name: PostgreSQL JSON Functions
  url: https://www.postgresql.org/docs/current/functions-json.html
  note: Auto-resolved from postgresql-json
- name: River Job Queue
  url: https://pkg.go.dev/github.com/riverqueue/river
  note: Auto-resolved from river
- name: sqlc
  url: https://docs.sqlc.dev/en/stable/
  note: Auto-resolved from sqlc
- name: sqlc Configuration
  url: https://docs.sqlc.dev/en/stable/reference/config.html
  note: Auto-resolved from sqlc-config
design_refs:
- title: 01_ARCHITECTURE
  path: ../../architecture/01_ARCHITECTURE.md
- title: 02_DESIGN_PRINCIPLES
  path: ../../architecture/02_DESIGN_PRINCIPLES.md
- title: 03_METADATA_SYSTEM
  path: ../../architecture/03_METADATA_SYSTEM.md
feature_name: Photos Library
module_name: photos_library
schema_name: public
content_types:
- Albums
- Photos
supported_formats:
- format: JPEG/JPG
  description: Standard photo format
  processing: Thumbnail generation, EXIF extraction
  preferred: true
- format: PNG
  description: Lossless image format
  processing: Thumbnail generation, transparency support
- format: WebP
  description: Modern web image format
  processing: Thumbnail generation, animation support
- format: HEIC/HEIF
  description: High Efficiency Image Format (Apple)
  processing: Convert to JPEG for web display
  notes: Requires govips with libheif
- format: RAW
  description: Camera RAW formats (CR2, NEF, ARW, DNG, RAF, ORF)
  processing: Convert to JPEG with govips/libraw
  notes: Read-only, preserve originals
exif_metadata_extraction:
  library: govips (libvips)
  extracted_fields:
  - GPS coordinates (latitude, longitude, altitude)
  - Camera make and model
  - Lens information
  - Exposure settings (ISO, aperture, shutter speed)
  - Focal length
  - Flash fired
  - Orientation
  - Date/time taken
  - Image dimensions
  - Color space
  privacy_options:
    strip_location: Option to strip GPS on share
    strip_camera: Option to strip camera metadata
database_schema: "**Schema**: `public`\n\n  **Tables**: See migration files for complete\
  \ schema\n\n  **Indexes**: Optimized for common queries and full-text search\n  "
organization_features:
  albums:
    types:
    - User-created albums
    - Shared albums (read/write permissions)
    - Smart albums (auto-populated by filters)
    management:
    - Add/remove photos
    - Reorder photos (drag-and-drop)
    - Set cover photo
    - Album descriptions
  people_tagging:
    face_detection: Manual tagging (optional ML in future)
    name_assignment: Tag faces with person names
    browse_by_person: View all photos of a person
  places:
    gps_extraction: From EXIF GPS coordinates
    reverse_geocoding: Optional reverse geocode to place names
    map_view: View photos on interactive map (Leaflet/Mapbox)
  tags:
    user_tags: Custom tags per photo
    autocomplete: Tag suggestions from existing tags
    browse_by_tag: Filter photos by tag
  favorites:
    marking: Star favorite photos
    quick_access: Favorites collection view
  search:
    fields: Title, tags, camera, location, date range
    fulltext: PostgreSQL full-text search
viewing_features:
  lightbox_gallery:
    library: PhotoSwipe or similar
    features:
    - Full-screen viewing
    - Zoom and pan
    - Swipe navigation
    - Thumbnail strip
    - Share button
    - Download button
  slideshow:
    auto_play: Configurable interval (3-10 seconds)
    transitions: Fade, slide, zoom
    controls: Play/pause, previous/next
  timeline_view:
    grouping: Group photos by date (day/month/year)
    scroll: Infinite scroll timeline
  grid_view:
    layouts: Justified grid, masonry, square grid
    thumbnail_sizes: Small, medium, large
  map_view:
    markers: Photo clusters on map
    popup: Photo preview on marker click
image_processing:
  thumbnail_generation:
    library: govips (libvips for performance)
    sizes:
    - thumb: 200x200 (square crop)
    - small: 400px width
    - medium: 800px width
    - large: 1600px width
    format: WebP for web, JPEG for compatibility
  blurhash:
    library: go-blurhash
    purpose: Low-quality placeholders while loading
    generation: On upload
  raw_conversion:
    library: govips with libraw
    output: JPEG for web viewing
    preservation: Keep original RAW file
api_endpoints:
- method: GET
  path: /api/v1/photos
  description: List all photos with pagination and filters
- method: GET
  path: /api/v1/photos/:id
  description: Get photo details by ID
- method: POST
  path: /api/v1/photos
  description: Upload a new photo
- method: DELETE
  path: /api/v1/photos/:id
  description: Delete a photo
- method: GET
  path: /api/v1/photos/:id/download
  description: Download original photo file
- method: GET
  path: /api/v1/photos/:id/thumbnail/:size
  description: Get photo thumbnail at specified size
- method: PUT
  path: /api/v1/photos/:id/tags
  description: Update tags for a photo
- method: PUT
  path: /api/v1/photos/:id/favorite
  description: Toggle favorite status for a photo
- method: GET
  path: /api/v1/photos/albums
  description: List all photo albums
- method: POST
  path: /api/v1/photos/albums
  description: Create a new photo album
- method: GET
  path: /api/v1/photos/albums/:id
  description: Get album details by ID
- method: POST
  path: /api/v1/photos/albums/:id/photos
  description: Add photos to an album
- method: GET
  path: /api/v1/photos/people
  description: List all tagged people
- method: POST
  path: /api/v1/photos/people
  description: Create a new person tag
- method: GET
  path: /api/v1/photos/timeline
  description: Get photos organized by timeline
- method: GET
  path: /api/v1/photos/map
  description: Get photos with location data for map view
architecture_diagram: "```\n  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n\
  \  â”‚   Client    â”‚â”€â”€â”€â”€â–¶â”‚  API Handler â”‚â”€â”€â”€â”€â–¶â”‚   Service   â”‚\n  â”‚  (Web/App)  â”‚â—€â”€â”€â”€â”€â”‚\
  \   (ogen)     â”‚â—€â”€â”€â”€â”€â”‚   (Logic)   â”‚\n  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   \
  \  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜\n                                                   â”‚\n     \
  \                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                \
  \            â–¼                      â–¼            â–¼\n                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\
  \          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”\n                      â”‚Repositoryâ”‚       \
  \   â”‚ Metadata  â”‚  â”‚  Cache â”‚\n                      â”‚  (sqlc)  â”‚          â”‚  Service\
  \  â”‚  â”‚(otter) â”‚\n                      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\
  \                           â”‚                      â”‚\n                         \
  \  â–¼                      â–¼\n                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n\
  \                    â”‚ PostgreSQL  â”‚        â”‚ External â”‚\n                    â”‚\
  \   (pgx)     â”‚        â”‚   APIs   â”‚\n                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       \
  \ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n  ```"
module_structure: "```\n  internal/content/photos_library/\n  â”œâ”€â”€ module.go      \
  \        # fx module definition\n  â”œâ”€â”€ repository.go          # Database operations\
  \ (sqlc)\n  â”œâ”€â”€ service.go             # Business logic\n  â”œâ”€â”€ handler.go      \
  \       # HTTP handlers (ogen)\n  â”œâ”€â”€ types.go               # Domain types\n  â””â”€â”€\
  \ cache.go               # Caching layer (otter)\n  ```"
component_interaction: "1. Client requests resource via HTTP\n  2. API handler validates\
  \ and routes to service\n  3. Service checks cache, queries repository if needed\n\
  \  4. Repository executes SQL via sqlc\n  5. Results return through layers to client"
