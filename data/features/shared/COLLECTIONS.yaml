doc_title: Collections & Playlists
doc_category: feature
created_date: '2026-01-31'
overall_status: âœ… Complete
status_design: âœ…
status_design_notes: '-'
status_sources: âœ…
status_sources_notes: '-'
status_instructions: âœ…
status_instructions_notes: Generated from design
status_code: ğŸ”´
status_code_notes: '-'
status_linting: ğŸ”´
status_linting_notes: '-'
status_unit_testing: ğŸ”´
status_unit_testing_notes: '-'
status_integration_testing: ğŸ”´
status_integration_testing_notes: '-'
technical_summary: '> User-created collections and playlists for organizing media
  across content types


  Collections allow users to group media items together:

  - **Manual Collections**: User-curated lists (e.g., "Best Sci-Fi Movies")

  - **Smart Collections**: Filter-based dynamic lists (e.g., "All 4K Movies")

  - **Cross-Type Collections**: Mix movies, TV shows, music in one collection

  - **User-Specific**: Each user can create their own collections

  - **Shared Collections**: Optional sharing between users

  '
wiki_tagline: '> Organize your media with custom collections and playlists

  '
wiki_overview: 'The Collections system lets you group any media into custom collections.
  Create manual collections by hand-picking items, or smart collections that automatically
  update based on filters. Mix and match movies, TV shows, albums, and more in a single
  collection. Share collections publicly or collaborate with other users. Perfect
  for creating themed collections like "Best of 2023", "Oscar Winners", or "Workout
  Music".

  '
sources:
- name: Uber fx
  url: https://pkg.go.dev/go.uber.org/fx
  note: Auto-resolved from fx
- name: ogen OpenAPI Generator
  url: https://pkg.go.dev/github.com/ogen-go/ogen
  note: Auto-resolved from ogen
design_refs:
- title: features/shared
  path: INDEX.md
- title: 01_ARCHITECTURE
  path: ../../architecture/01_ARCHITECTURE.md
- title: LIBRARY_TYPES
  path: ../../features/shared/LIBRARY_TYPES.md
feature_name: Collections & Playlists
module_name: collections
schema_name: public
content_types:
- Movies
- TV Shows
- Music
- All media types
collection_types:
  manual:
    name: Manual Collections
    description: User-curated lists of specific items
    use_cases:
    - Best Sci-Fi Movies
    - Family Movie Night Picks
    - Workout Music
  smart:
    name: Smart Collections
    description: Dynamic collections based on filters
    use_cases:
    - All 4K Movies
    - Recently Added (Last 30 Days)
    - Unwatched TV Shows
    - 5-Star Rated Content
    filters:
    - Resolution (4K, 1080p, 720p)
    - Rating (user rating, content rating)
    - Genre
    - Release year
    - Date added
    - Watch status
database_schema: "**Schema**: `public`\n\n  **Tables**: See migration files for complete\
  \ schema\n\n  **Indexes**: Optimized for common queries and full-text search\n  "
api_endpoints:
- method: POST
  path: /api/v1/collections
  description: Create a new collection
  auth_required: true
  request_example: "{\n  \"name\": \"Best Sci-Fi\",\n  \"description\": \"My favorite\
    \ science fiction movies\",\n  \"type\": \"manual\",\n  \"is_public\": false\n\
    }\n"
  response_example: "{\n  \"id\": \"uuid-123\",\n  \"name\": \"Best Sci-Fi\",\n  \"\
    type\": \"manual\",\n  \"is_public\": false,\n  \"created_at\": \"2026-01-31T12:00:00Z\"\
    \n}\n"
- method: GET
  path: /api/v1/collections
  description: List user's collections
  auth_required: true
  query_params:
  - type (optional): Filter by manual/smart
  - public (optional): Show only public collections
  request_example: '{}'
  response_example: "{\n  \"collections\": [\n    {\"id\": \"uuid-123\", \"name\"\
    : \"Best Sci-Fi\", \"type\": \"manual\", \"item_count\": 12}\n  ]\n}\n"
- method: GET
  path: /api/v1/collections/{id}
  description: Get collection details with items
  auth_required: true
  request_example: '{}'
  response_example: "{\n  \"id\": \"uuid-123\",\n  \"name\": \"Best Sci-Fi\",\n  \"\
    items\": [\n    {\"type\": \"movie\", \"id\": \"uuid-456\", \"title\": \"Inception\"\
    }\n  ]\n}\n"
- method: PUT
  path: /api/v1/collections/{id}
  description: Update collection metadata
  auth_required: true
  request_example: "{\n  \"name\": \"Updated Name\",\n  \"description\": \"New description\"\
    \n}\n"
  response_example: "{\n  \"id\": \"uuid-123\",\n  \"name\": \"Updated Name\",\n \
    \ \"updated_at\": \"2026-01-31T13:00:00Z\"\n}\n"
- method: DELETE
  path: /api/v1/collections/{id}
  description: Delete collection
  auth_required: true
  request_example: '{}'
  response_example: 204 No Content
- method: POST
  path: /api/v1/collections/{id}/items
  description: Add items to collection
  auth_required: true
  request_example: "{\n  \"items\": [\n    {\"type\": \"movie\", \"id\": \"uuid-123\"\
    },\n    {\"type\": \"tvshow\", \"id\": \"uuid-456\"}\n  ]\n}\n"
  response_example: "{\n  \"added\": 2,\n  \"item_count\": 14\n}\n"
- method: DELETE
  path: /api/v1/collections/{id}/items/{item_id}
  description: Remove item from collection
  auth_required: true
  request_example: '{}'
  response_example: 204 No Content
implementation_notes: '**Service Layer** (`internal/service/collections`):

  - `CreateCollection(ctx, userID, name, type, filters)`

  - `ListCollections(ctx, userID, filters)`

  - `GetCollection(ctx, collectionID)`

  - `AddItems(ctx, collectionID, items)`

  - `RemoveItem(ctx, collectionID, itemID)`

  - `GetCollectionItems(ctx, collectionID)` - resolve polymorphic refs


  **Smart Collection Evaluation**:

  - Filters stored as JSONB

  - Evaluated at query time (no pre-materialization)

  - Cache results for 5 minutes (otter L1)


  **Permissions**:

  - Users can only CRUD their own collections

  - Public collections readable by all authenticated users

  - Admin can view/delete any collection

  '
smart_collection_filter_examples: "```json\n// All 4K movies\n{\n  \"item_type\":\
  \ \"movie\",\n  \"filters\": {\n    \"resolution\": \"4K\",\n    \"video_codec\"\
  : \"HEVC\"\n  }\n}\n\n// Recently added (last 30 days)\n{\n  \"filters\": {\n  \
  \  \"added_after\": \"2026-01-01T00:00:00Z\"\n  }\n}\n\n// Unwatched high-rated\
  \ movies\n{\n  \"item_type\": \"movie\",\n  \"filters\": {\n    \"watched\": false,\n\
  \    \"user_rating_min\": 4.0\n  }\n}\n```\n"
frontend_integration: '- Collections page: `/collections`

  - Create collection modal

  - Drag-and-drop to reorder items

  - Filter builder UI for smart collections

  - Share collection URL: `/collections/{id}/share`

  '
architecture_diagram: "```\n  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n\
  \  â”‚   Client    â”‚â”€â”€â”€â”€â–¶â”‚  API Handler â”‚â”€â”€â”€â”€â–¶â”‚   Service   â”‚\n  â”‚  (Web/App)  â”‚â—€â”€â”€â”€â”€â”‚\
  \   (ogen)     â”‚â—€â”€â”€â”€â”€â”‚   (Logic)   â”‚\n  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   \
  \  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜\n                                                   â”‚\n     \
  \                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                \
  \            â–¼                      â–¼            â–¼\n                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\
  \          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”\n                      â”‚Repositoryâ”‚       \
  \   â”‚ Metadata  â”‚  â”‚  Cache â”‚\n                      â”‚  (sqlc)  â”‚          â”‚  Service\
  \  â”‚  â”‚(otter) â”‚\n                      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\
  \                           â”‚                      â”‚\n                         \
  \  â–¼                      â–¼\n                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n\
  \                    â”‚ PostgreSQL  â”‚        â”‚ External â”‚\n                    â”‚\
  \   (pgx)     â”‚        â”‚   APIs   â”‚\n                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       \
  \ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n  ```"
module_structure: "```\n  internal/content/collections/\n  â”œâ”€â”€ module.go         \
  \     # fx module definition\n  â”œâ”€â”€ repository.go          # Database operations\
  \ (sqlc)\n  â”œâ”€â”€ service.go             # Business logic\n  â”œâ”€â”€ handler.go      \
  \       # HTTP handlers (ogen)\n  â”œâ”€â”€ types.go               # Domain types\n  â””â”€â”€\
  \ cache.go               # Caching layer (otter)\n  ```"
component_interaction: "1. Client requests resource via HTTP\n  2. API handler validates\
  \ and routes to service\n  3. Service checks cache, queries repository if needed\n\
  \  4. Repository executes SQL via sqlc\n  5. Results return through layers to client"
