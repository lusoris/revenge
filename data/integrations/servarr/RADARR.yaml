doc_title: Radarr Integration
doc_category: integration
created_date: '2026-01-31'
overall_status: âœ… Complete
status_design: âœ…
status_design_notes: '-'
status_sources: âœ…
status_sources_notes: '-'
status_instructions: ðŸŸ¡
status_instructions_notes: '-'
status_code: ðŸ”´
status_code_notes: '-'
status_linting: ðŸ”´
status_linting_notes: '-'
status_unit_testing: ðŸ”´
status_unit_testing_notes: '-'
status_integration_testing: ðŸ”´
status_integration_testing_notes: '-'
technical_summary: '> Movie management automation and metadata synchronization'
wiki_tagline: '> Automatic movie downloads with Radarr'
wiki_overview: Radarr integration enables automatic movie downloads and library management. Request movies in Revenge and
  Radarr handles finding and downloading them. Webhooks notify Revenge when new movies arrive. Library status shows which
  movies are monitored and their quality. Connect by entering your Radarr URL and API key.
sources:
- name: Uber fx
  url: https://pkg.go.dev/go.uber.org/fx
  note: Auto-resolved from fx
- name: Go context
  url: https://pkg.go.dev/context
  note: Auto-resolved from go-context
- name: pgx PostgreSQL Driver
  url: https://pkg.go.dev/github.com/jackc/pgx/v5
  note: Auto-resolved from pgx
- name: PostgreSQL Arrays
  url: https://www.postgresql.org/docs/current/arrays.html
  note: Auto-resolved from postgresql-arrays
- name: PostgreSQL JSON Functions
  url: https://www.postgresql.org/docs/current/functions-json.html
  note: Auto-resolved from postgresql-json
- name: Radarr API Docs
  url: https://radarr.video/docs/api/
  note: Auto-resolved from radarr-docs
- name: River Job Queue
  url: https://pkg.go.dev/github.com/riverqueue/river
  note: Auto-resolved from river
- name: Servarr Wiki
  url: https://wiki.servarr.com/
  note: Auto-resolved from servarr-wiki
- name: Typesense API
  url: https://typesense.org/docs/latest/api/
  note: Auto-resolved from typesense
- name: Typesense Go Client
  url: https://github.com/typesense/typesense-go
  note: Auto-resolved from typesense-go
design_refs:
- title: 01_ARCHITECTURE
  path: ../../architecture/01_ARCHITECTURE.md
- title: 02_DESIGN_PRINCIPLES
  path: ../../architecture/02_DESIGN_PRINCIPLES.md
- title: 03_METADATA_SYSTEM
  path: ../../architecture/03_METADATA_SYSTEM.md
integration_name: Radarr
integration_id: radarr
external_service: Radarr
auth_method: api_key
api_base_url: http://localhost:7878/api/v3
dual_role_metadata_and_downloads: |
  **CRITICAL: Radarr serves DUAL purposes in the Revenge architecture**:

  **1. PRIMARY Metadata Aggregator**:
  - Radarr is the PRIMARY source for movie metadata in Revenge
  - It aggregates metadata from TMDb (The Movie Database)
  - Maintains local cache of movie information (title, year, cast, crew, posters, etc.)
  - Revenge queries Radarr API for movie metadata BEFORE falling back to direct TMDb API
  - Provides unified, consistent metadata interface
  - Reduces direct API calls to external services (rate limiting, availability)

  **2. Download Automation Manager**:
  - Handles movie acquisition through configured indexers and download clients
  - Monitors for new releases and automatically downloads based on quality profiles
  - Manages file organization and naming
  - Webhooks notify Revenge when files are ready

  **Metadata Flow**:
  ```
  External (TMDb) â†’ Radarr (local aggregation) â†’ Revenge
                         â†“
               (optional direct TMDb for enrichment)
  ```

  **Why This Matters**:
  - Radarr is NOT just a download tool - it's the metadata backbone for movies
  - Direct TMDb integration is SUPPLEMENTARY for real-time updates/enrichment
  - This pattern applies to ALL Arr services:
    - Radarr â†’ Movies (TMDb metadata)
    - Sonarr â†’ TV Shows (TheTVDB metadata)
    - Lidarr â†’ Music (MusicBrainz metadata)
    - Chaptarr â†’ Books/Audiobooks (GoodReads/OpenLibrary metadata)
    - Whisparr â†’ Adult Content (StashDB metadata)
architecture_diagram: |-
  ```mermaid
  flowchart TD
      subgraph row1[ ]
          direction LR
          node1["Revenge<br/>Request<br/>System"]
          node2["Radarr<br/>Integration"]
          node3["Radarr<br/>Server"]
      end
      node4(["Webhook<br/>Handler"])
      node1 --> node2
      node2 --> node3
      node3 --> node4

      %% Hide row subgraph borders
      style row1 fill:transparent,stroke:transparent
  ```
api_details: |
  **API Version**: v3
  **Base URL**: `http://localhost:7878/api/v3` (configurable)
  **Authentication**: X-Api-Key header
  **Rate Limit**: None (local service)

  **Key Endpoints**:
  - `/movie` - List/add/delete movies
  - `/movie/{id}` - Get/update movie details
  - `/movie/lookup` - Search for movies (TMDb)
  - `/qualityprofile` - Get quality profiles
  - `/rootfolder` - Get root folders
  - `/command` - Trigger commands (search, refresh)
  - `/history` - Get download history
  - `/calendar` - Get upcoming releases
database_schema: |
  **Schema**: `public`

  ```sql
  -- Radarr instance configuration
  CREATE TABLE radarr_instances (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),

    name VARCHAR(255) NOT NULL,
    base_url TEXT NOT NULL,
    api_key TEXT NOT NULL,

    -- Settings
    enabled BOOLEAN DEFAULT true,
    auto_sync BOOLEAN DEFAULT true,
    sync_interval INTEGER DEFAULT 300,    -- seconds

    created_at TIMESTAMPTZ DEFAULT now(),
    updated_at TIMESTAMPTZ DEFAULT now()
  );

  -- Movie to Radarr mapping
  CREATE TABLE radarr_movies (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),

    movie_id UUID NOT NULL REFERENCES movies(id) ON DELETE CASCADE,
    radarr_instance_id UUID NOT NULL REFERENCES radarr_instances(id) ON DELETE CASCADE,

    radarr_movie_id INTEGER NOT NULL,     -- Radarr's internal ID
    monitored BOOLEAN DEFAULT true,
    quality_profile_id INTEGER,
    has_file BOOLEAN DEFAULT false,
    file_path TEXT,

    last_synced_at TIMESTAMPTZ,
    UNIQUE(movie_id, radarr_instance_id)
  );
  CREATE INDEX idx_radarr_movies_instance ON radarr_movies(radarr_instance_id);
  ```
module_structure: |
  ```
  internal/integrations/radarr/
  â”œâ”€â”€ module.go                    # fx module
  â”œâ”€â”€ client.go                    # Radarr API client
  â”œâ”€â”€ service.go                   # Integration service
  â”œâ”€â”€ sync.go                      # Library sync (River job)
  â”œâ”€â”€ webhook.go                   # Webhook handler
  â”œâ”€â”€ types.go                     # Radarr API types
  â””â”€â”€ radarr_test.go
  ```
key_interfaces: |
  ```go
  // Radarr integration service
  type RadarrService interface {
    // Movie management
    AddMovie(ctx context.Context, tmdbID int, qualityProfileID int, rootFolder string) (*RadarrMovie, error)
    DeleteMovie(ctx context.Context, radarrID int, deleteFiles bool) error
    SearchMovie(ctx context.Context, radarrID int) error  // Trigger download

    // Sync
    SyncLibrary(ctx context.Context, instanceID uuid.UUID) error
    GetMovieStatus(ctx context.Context, movieID uuid.UUID) (*MovieStatus, error)

    // Calendar
    GetUpcoming(ctx context.Context, start, end time.Time) ([]CalendarEntry, error)
  }

  // Radarr movie structure
  type RadarrMovie struct {
    ID              int      `json:"id"`
    Title           string   `json:"title"`
    Year            int      `json:"year"`
    TMDbID          int      `json:"tmdbId"`
    IMDbID          string   `json:"imdbId"`
    Monitored       bool     `json:"monitored"`
    QualityProfile  int      `json:"qualityProfileId"`
    RootFolderPath  string   `json:"rootFolderPath"`
    Path            string   `json:"path"`
    HasFile         bool     `json:"hasFile"`
    SizeOnDisk      int64    `json:"sizeOnDisk"`
  }
  ```
dependencies: |
  **Go Packages**:
  - `net/http` - HTTP client
  - `github.com/google/uuid` - UUID support
  - `github.com/jackc/pgx/v5` - PostgreSQL driver
  - `github.com/riverqueue/river` - Background sync jobs
  - `go.uber.org/fx` - Dependency injection

  **External Services**:
  - Radarr v3+ (self-hosted)
env_vars: |
  ```bash
  # Radarr instance
  RADARR_URL=http://localhost:7878
  RADARR_API_KEY=your_api_key_here

  # Sync settings
  RADARR_AUTO_SYNC=true
  RADARR_SYNC_INTERVAL=300  # 5 minutes
  ```
config_keys: |
  ```yaml
  integrations:
    radarr:
      instances:
        - name: Main Radarr
          base_url: http://localhost:7878
          api_key: ${RADARR_API_KEY}
          enabled: true
          auto_sync: true
          sync_interval: 300
  ```
component_interaction: |
  **Add Movie to Radarr** (from Revenge request):
  1. User requests movie in Revenge
  2. Request system calls RadarrService.AddMovie(tmdbID, profileID, rootFolder)
  3. POST to /api/v3/movie with movie details
  4. Radarr adds movie and starts monitoring
  5. Store radarr_movie_id in radarr_movies table
  6. Radarr searches for downloads automatically
  7. When downloaded, Radarr sends webhook to Revenge

  **Webhook Processing** (on download complete):
  1. Radarr sends POST to /api/v1/webhooks/radarr
  2. Payload includes eventType: "Download", movieId, filePath
  3. Webhook handler extracts data
  4. Update radarr_movies: has_file=true, file_path=...
  5. Trigger library scan to import movie file
  6. Movie becomes available in Revenge

  **Library Sync** (background):
  1. River job runs every 5 minutes
  2. GET /api/v3/movie from Radarr
  3. Compare with radarr_movies table
  4. Update monitored status, has_file, file_path
  5. Create/update movies in Revenge library
api_request_examples: |
  **Add Movie**:
  ```
  POST http://localhost:7878/api/v3/movie
  X-Api-Key: your_api_key

  {
    "title": "Inception",
    "year": 2010,
    "tmdbId": 27205,
    "qualityProfileId": 1,
    "rootFolderPath": "/movies",
    "monitored": true,
    "addOptions": {
      "searchForMovie": true
    }
  }
  ```

  **Search for Movie Downloads**:
  ```
  POST http://localhost:7878/api/v3/command
  X-Api-Key: your_api_key

  {
    "name": "MoviesSearch",
    "movieIds": [123]
  }
  ```

  **Get Movie**:
  ```
  GET http://localhost:7878/api/v3/movie/123
  X-Api-Key: your_api_key
  ```
webhook_handling: |
  **Supported Events**:
  - **Download**: Movie downloaded and imported
  - **Rename**: Movie file renamed
  - **MovieDelete**: Movie deleted from Radarr
  - **Health**: Health check event

  **Webhook Payload** (Download event):
  ```json
  {
    "eventType": "Download",
    "movie": {
      "id": 123,
      "title": "Inception",
      "year": 2010,
      "tmdbId": 27205,
      "imdbId": "tt1375666",
      "path": "/movies/Inception (2010)"
    },
    "movieFile": {
      "id": 456,
      "relativePath": "Inception.2010.1080p.BluRay.x264.mkv",
      "path": "/movies/Inception (2010)/Inception.2010.1080p.BluRay.x264.mkv",
      "quality": "Bluray-1080p",
      "size": 12884901888
    }
  }
  ```

  **Handler Logic**:
  1. Verify webhook signature (if configured)
  2. Parse event type
  3. Update database based on event
  4. Trigger library rescan if needed
quality_profiles: |
  **Quality Profiles**:
  - Define preferred quality (720p, 1080p, 4K)
  - Upgrade automatically when better quality available

  **Example Profiles**:
  - HD-1080p: Prefer 1080p, upgrade from 720p
  - Ultra-HD: Prefer 4K/2160p
  - Any: Accept any quality

  **API**:
  ```
  GET /api/v3/qualityprofile
  ```

  **Response**:
  ```json
  [
    {
      "id": 1,
      "name": "HD-1080p",
      "upgradeAllowed": true,
      "cutoff": 8,
      "items": [...]
    }
  ]
  ```
unit_tests: |
  ```go
  func TestRadarrService_AddMovie(t *testing.T) {
    // Test adding movie to Radarr
  }

  func TestRadarrWebhook_Download(t *testing.T) {
    // Test webhook processing
  }
  ```
integration_tests: |
  ```go
  func TestRadarr_FullWorkflow(t *testing.T) {
    // Use testcontainers for Radarr (if available)
    // Test add, sync, webhook
  }
  ```
